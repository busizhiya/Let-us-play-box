# Y0usef

**é¶æœºåç§°**:vulnhub------**Y0USEF**

**é¶æœºé“¾æ¥**:https://www.vulnhub.com/entry/y0usef-1,624/

**éš¾åº¦**:*Easy*

**æ”»å‡»æœº**:Kali Linux

**ä½¿ç”¨å·¥å…·**:

## ç®€ä»‹

æ­¤æ¬¡,æˆ‘ä»¬æ‰“çš„æ˜¯ä¸€å°Easyéš¾åº¦çš„é¶æœº.æœ‰çš„å°ä¼™ä¼´å¯èƒ½ä¼šç–‘æƒ‘:"æˆ‘ä»¬æ€ä¹ˆä¸æ‰“ä¸­é«˜éš¾åº¦çš„é¶æœºå‘¢?è¿™æ ·ä¸æ˜¯èƒ½å­¦åˆ°æ›´å¤šä¸œè¥¿å—?"

å„ä½ä¸è¦å¤±æœ›,å…¶å®ä½éš¾åº¦çš„é¶æœºä¸æ„å‘³ç€æ²¡æœ‰é«˜è´¨é‡çš„æ¼æ´,æ°æ°ç›¸å,æ­£æ˜¯å› ä¸ºè¿™äº›æ¼æ´å±å®³å¤§,åˆ©ç”¨ç®€å•,åœ¨ç”Ÿæ´»ä¸­åˆå¸¸è§,æ‰€ä»¥æ‰è¢«åˆ—ä¸ºä½éš¾åº¦æ¼æ´~

å¸Œæœ›å¤§å®¶æ‰“å®åŸºç¡€,å¯¹æ¼æ´è¿›è¡Œæ›´åŠ æ·±å…¥çš„çš„äº†è§£ä¸æ¢ç©¶,åŠ æ²¹~

æœ¬æ¬¡çš„ç‰¹è‰²æ”»å‡»æ‰‹æ®µä¸º:403bypass,æ–‡ä»¶ä¸Šä¼ 

## ä¿¡æ¯æ”¶é›†

### ä¸»æœºå‘ç°

è€æœ‹å‹~`sudo arp-scan -l`

![æˆªå±2021-09-22 ä¸‹åˆ2.30.42](https://tva1.sinaimg.cn/large/008i3skNly1gupe4yphzwj614c0ektdr02.jpg)

### ç«¯å£æ‰«æ

å…¨ç«¯å£æ‰«æ:`sudo nmap -p- 10.0.0.12`

![æˆªå±2021-09-22 ä¸‹åˆ2.43.41](https://tva1.sinaimg.cn/large/008i3skNly1gupeiechxvj60s009k0uf02.jpg)

æœåŠ¡ç‰ˆæœ¬æ‰«æ:` sudo nmap -p22,80 -sC -sV 10.0.0.12`

![æˆªå±2021-09-22 ä¸‹åˆ2.44.31](https://tva1.sinaimg.cn/large/008i3skNly1gupej8cb8cj612a0g00yd02.jpg)

æœ€åŸºæœ¬çš„22sshä¸80ApacheæœåŠ¡

OS:Ubuntu

æ€è·¯ä¼¼ä¹å¾ˆå±€é™,åªæœ‰webç•Œé¢è¿™ä¸€ä¸ªçªç ´å£!

## webé¡µé¢

![æˆªå±2021-09-22 ä¸‹åˆ2.46.21](https://tva1.sinaimg.cn/large/008i3skNly1gupel456ufj61140u041302.jpg)

emm..åªæœ‰ç©ºç©ºçš„å‡ ä¸ªå¤§å­—,"ç½‘ç«™å»ºè®¾ä¸­",çœ‹çœ‹é¡µé¢æºä»£ç ?

![æˆªå±2021-09-22 ä¸‹åˆ2.46.55](https://tva1.sinaimg.cn/large/008i3skNly1gupeloirxsj61140u0jvx02.jpg)

è¿™...ä¹Ÿä»€ä¹ˆéƒ½æ²¡æœ‰.

é€šå¸¸æ¥è¯´,æˆ‘ä»¬å¯¹webç•Œé¢çš„æ”»å‡»æœ‰ä¸¤ç§æ–¹å¼:

1.é¡µé¢å¾ˆä¸°å¯Œ,ä¿¡æ¯å¾ˆå……è¶³,æ ¹æ®é¡µé¢åŠŸèƒ½è¿›è¡Œæ”»å‡»

2.èƒ½è·å–çš„ä¿¡æ¯å¾ˆå°‘,é€šè¿‡è·¯å¾„çˆ†ç ´ã€ç½‘ç«™æŒ‡çº¹ç­‰è·å¾—æ›´å¤šä¿¡æ¯~

çœ‹æ¥æˆ‘ä»¬è¦è¿›ä¸€æ­¥çš„æŒ–æ˜webé¡µé¢å•¦~

### æŒ‡çº¹è¯†åˆ«?

æˆ‘ä»¬ä»‹ç»ä¸€ä¸ªå·¥å…·â€”â€”`whatweb`,ç”¨äºç½‘ç«™æŒ‡çº¹ä¿¡æ¯æŒ–æ˜~

æŒ‡çº¹è¯†åˆ«æ˜¯ä»€ä¹ˆå‘¢?ç®€å•æ¥è¯´,å°±æ˜¯é€šè¿‡å¦‚ç›¸åº”å¤´,é¡µé¢å…³é”®å­—ç­‰ä¿¡æ¯è·å–æœåŠ¡å™¨æ‰€ä½¿ç”¨çš„ç¯å¢ƒã€æ“ä½œç³»ç»Ÿã€cmsç­‰ç­‰...

`whatweb http://10.0.0.12/`

![æˆªå±2021-09-22 ä¸‹åˆ2.51.20](https://tva1.sinaimg.cn/large/008i3skNly1gupeqaqv0pj61k604eabt02.jpg)

æˆ‘ä»¬è·å¾—äº†å¾ˆå¤šä¿¡æ¯:

â€‹	ä¸­é—´ä»¶:Apache2.4.10,

â€‹	OS:Ubuntu Linux

â€‹	PHP:5.5.9

è¿™æ—¶,æˆ‘ä»¬å°±å¯ä»¥æœä¸€ä¸‹æœ‰æ²¡æœ‰ç°æœ‰çš„æ¼æ´å•¦~

`searchsploit Apache 2.4.10`

`searchsploit php 5.5.9`

æŸ¥çœ‹å,å‡æ²¡æœ‰ç¬¦åˆçš„æ¼æ´...

å®³,åˆ«æ°”é¦,æˆ‘ä»¬è¿˜æœ‰å¦ä¸€æ‰‹~

### brute-forceğŸ‘Š!

åˆ«å¿˜äº†,æ–‡çš„ä¸è¡Œå’±ä»¬æ¥æ­¦çš„~ä½¿ç”¨dirsearchæ‰«æç›®å½•

`dirsearch  -u "http://10.0.0.12"`

![æˆªå±2021-09-22 ä¸‹åˆ3.03.57](https://tva1.sinaimg.cn/large/008i3skNly1gupf3fhswkj60zi0nwtdk02.jpg)

æŸ¥çœ‹`/index.php`å’Œ`/index.php/login/`é¡µé¢å‡æ— æ”¶è·,è¿˜æ˜¯å’Œä¹‹å‰ä¸€æ ·çš„ç©ºç™½~

å†çœ‹çœ‹`/adminstration/`ç›®å½•,å¯èƒ½æœ‰æˆ!

### 403?bypass!!

![æˆªå±2021-09-24 ä¸‹åˆ5.35.45](https://tva1.sinaimg.cn/large/008i3skNly1guruq2oll1j61140u0ack02.jpg)

emm?403??è¿™å¯å’‹æ•´!

å½“æˆ‘ä»¬åœ¨å®é™…çš„æ¸—é€ä¸­,å¾€å¾€ä¼šçœ‹åˆ°è¿™æ ·çš„æƒ…å†µ,å¾ˆå¤šåŒå­¦å¯èƒ½å°±æ”¾å¼ƒäº†~

ä½†æ˜¯,ä¸è¦æ”¾å¼ƒ!è¿™é‡Œä¸ºå¤§å®¶ä»‹ç»ä¸€äº›403bypassçš„æ–¹æ³•

è¯·çœ‹:é™„å½•â€”â€”**403Bypass**



æœ€ç»ˆ,æˆ‘ä»¬é€šè¿‡burpæ‹¦æˆªå¹¶ä¿®æ”¹`X-Forwarded-For: 127.0.0.1`(XFF)å¤´éƒ¨æˆåŠŸç»•è¿‡äº†æ£€æµ‹!

å¦‚æœæ¥ä¸‹æ¥æˆ‘ä»¬æƒ³è¦åœ¨æµè§ˆå™¨ä¸­æŒç»­å¸¦ç€XFFå¤´éƒ¨è®¿é—®,è¦ä¹ˆæ‰‹å·¥ä¿®æ”¹æ¯ä¸€ä¸ªæ•°æ®åŒ…,è¦ä¹ˆé€šè¿‡ä½¿ç”¨æµè§ˆå™¨æ’ä»¶æˆ–è€…burpæ’ä»¶è‡ªåŠ¨æ·»åŠ ,è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨æ’ä»¶â€”â€”`ModHeader`

å®‰è£…æ–¹æ³•ä¸å†èµ˜è¿°,æ‰“å¼€ç«ç‹æµè§ˆå™¨æ’ä»¶è‡ªè¡Œå®‰è£…å³å¯

![æˆªå±2021-09-24 ä¸‹åˆ6.26.29](https://tva1.sinaimg.cn/large/008i3skNly1gurw6vxg22j61080u0q7a02.jpg)

![æˆªå±2021-09-24 ä¸‹åˆ6.32.07](https://tva1.sinaimg.cn/large/008i3skNly1gurwconyi3j61080u0jug02.jpg)

ç®€ç®€å•å•~æˆåŠŸbypass!

ps:éš¾é“æ¯ä¸€æ¬¡é‡åˆ°403ç•Œé¢éƒ½è¦æ‰‹åŠ¨å»æµ‹è¯•æ˜¯å¦èƒ½è¿‡bypasså—?å½“ç„¶ä¸ç”¨!è¯·çœ‹é™„å½•â€”â€”burpæ’ä»¶-403bypasser.py

### æ–‡ä»¶ä¸Šä¼ ğŸ˜†~~

æˆ‘ä»¬å°è¯•`admin/admin`ç™»é™†~

æˆåŠŸäº†!

![æˆªå±2021-09-24 ä¸‹åˆ6.33.45](https://tva1.sinaimg.cn/large/008i3skNly1gurwedfyzjj61880u0wiy02.jpg)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°,æ—è¾¹æœ‰å‡ ä¸ªåŠŸèƒ½,å…¶ä¸­æœ€ä»¤äººå¿ƒåŠ¨çš„å°±æ˜¯`Upload file`æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½å•¦!

æˆ‘ä»¬é€‰æ‹©kalié»˜è®¤çš„shellè¿›è¡Œä¸Šä¼ `/usr/share/webshells/php/php-reverse-shell.php`

![æˆªå±2021-09-24 ä¸‹åˆ6.43.20](https://tva1.sinaimg.cn/large/008i3skNly1gurwobm844j61880u0n4l02.jpg)

ä¸€èˆ¬æ¥è¯´,æ–‡ä»¶ä¸Šä¼ ç‚¹éƒ½ä¼šæœ‰äº›è®¸çš„é˜²æŠ¤æªæ–½,è¯·è§é™„å½•â€”â€”**æ–‡ä»¶ä¸Šä¼ ç»•è¿‡**

æˆ‘ä»¬ä¿®æ”¹MIMEç±»å‹(Content-Type)ä¸º`image/png`

![æˆªå±2021-09-24 ä¸‹åˆ6.43.59](https://tva1.sinaimg.cn/large/008i3skNly1gurwoystejj61880u0gt702.jpg)

æˆåŠŸbypass!

å¯ä»¥çœ‹åˆ°,å®ƒè¿”å›äº†æ–‡ä»¶çš„åœ°å€,æˆ‘ä»¬è®¿é—®ä¸€ä¸‹

`http://10.0.0.12/adminstration/upload/files/1632480236php-reverse-shell.php`

![æˆªå±2021-09-24 ä¸‹åˆ6.45.10](https://tva1.sinaimg.cn/large/008i3skNly1gurwq87rocj61e00can0n02.jpg)

## ææƒ

ç…§å¸¸çš„python ptyå‡çº§,æˆ‘ä»¬å†çœ‹çœ‹æœ‰ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿

æŸ¥çœ‹ç”¨æˆ·,`yousef`å’Œ`guest-cpxNn2`,å¥‡æ€ªçš„ç”¨æˆ·...

![æˆªå±2021-09-24 ä¸‹åˆ6.47.32](https://tva1.sinaimg.cn/large/008i3skNly1gurwsp6mqnj60wa0u04b102.jpg)

æˆ‘ä»¬è¿›å…¥/homeç›®å½•çœ‹çœ‹~

![æˆªå±2021-09-24 ä¸‹åˆ6.49.46](https://tva1.sinaimg.cn/large/008i3skNly1gurwuztqkgj60p006idh402.jpg)

wow~æœ‰flagè¯¶!

user.txt:`c3NoIDogCnVzZXIgOiB5b3VzZWYgCnBhc3MgOiB5b3VzZWYxMjM=`

å’¦?ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰è§‰å¾—è¿™ä¸ªflagå¾ˆå¥‡æ€ª!æœ‰ç‚¹åƒ...åƒ...**base64**!!

ä¸€èˆ¬æ¥è¯´,base64çš„å¯†æ–‡åŒ…å«0-9a-zA-Z/+=è¿™äº›å­—ç¬¦,å°¤å…¶æ˜¯å±è‚¡åé¢è·Ÿç€çš„"å°å°¾å·´"æ˜¯å®ƒæœ€æ˜æ˜¾çš„ç‰¹å¾!

æˆ‘ä»¬è¿›è¡Œbase64è§£ç 

`cat user.txt | base64 -d`

![æˆªå±2021-09-24 ä¸‹åˆ6.53.41](https://tva1.sinaimg.cn/large/008i3skNly1gurwz2ojjlj60qw04kaaw02.jpg)

å“ˆå“ˆ,å¤šæ˜æ˜¾å•Š!ç›´æ¥æŠŠè´¦å·å¯†ç éƒ½ç»™æˆ‘ä»¬äº†

æˆ‘ä»¬ä½¿ç”¨`su yousef`è¿›è¡Œç™»é™†

æ—¢ç„¶å·²ç»çŸ¥é“äº†å¯†ç ,æˆ‘ä»¬å°è¯•sudoæƒé™!

![æˆªå±2021-09-24 ä¸‹åˆ6.54.38](https://tva1.sinaimg.cn/large/008i3skNly1gurx02f5d4j611g090gni02.jpg)

å“ˆå“ˆ,å±…ç„¶å¯ä»¥æ‰§è¡Œå…¨éƒ¨å‘½ä»¤!

`sudo su`æˆåŠŸè·å¾—rootæƒé™

![æˆªå±2021-09-24 ä¸‹åˆ6.55.51](https://tva1.sinaimg.cn/large/008i3skNly1gurx1cuxuhj61cs0ekwij02.jpg)

root.txt:`You've got the root Congratulations any feedback content me twitter @y0usef_11root`

**PWN**!ç®€å•çš„ææƒ~

## æ€»ç»“

æœ¬æ¬¡æ‰“é¶è¿‡ç¨‹ä¸­,æˆ‘ä»¬åˆ†äº«äº†å…³äº403bypasså’Œæ–‡ä»¶ä¸Šä¼ ç»•è¿‡çš„è®¸å¤šå¹²è´§!

é¦–å…ˆå¸¸è§çš„ä¸»æœºå‘ç°å’Œç«¯å£æ‰«æ,æˆ‘ä»¬ä¸€ç¬”å¸¦è¿‡~

åœ¨webç•Œé¢ä¸Š,æˆ‘ä»¬é‡åˆ°äº†å›°éš¾!åªå‘ç°äº†`/adminstration`ç›®å½•,è€Œä¸”è¿˜è¢«é™åˆ¶403...

å¾ˆå¤šåŒå­¦å¯èƒ½ä¸€ä¸‹å­å°±æ”¾å¼ƒäº†403é¡µé¢,ä½†æ˜¯åˆ«æ‹…å¿ƒ,æˆ‘ä»¬è¿™ä¸€æ¬¡åˆ†äº«äº†ç»•è¿‡403çš„å¾ˆå¤šå¹²è´§,å¸Œæœ›å¤§å®¶èƒ½å¤Ÿå¥½å¥½å­¦ä¹ è®°å½•,åœ¨çœŸå®çš„æ¸—é€è¿‡ç¨‹ä¸­ç”¨å‡ºæ¥!

å¯¹äºæœ¬æ¬¡é¶æœº,éš¾ç‚¹åœ¨äºå¯¹403çš„ç»•è¿‡,ä¸€æ—¦ç»•è¿‡å°±è±ç„¶å¼€æœ—!

ç®€å•çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´,è™½ç„¶æœ‰å°å°çš„æ£€æµ‹,ä½†æ˜¯æˆ‘ä»¬é€šè¿‡ç®€å•ä¿®æ”¹MIMEç±»å‹æˆåŠŸç»•è¿‡,è·å¾—äº†shell.

æœ¬æ¬¡çš„ææƒæ›´æ˜¯ç®€å•,å…³é”®åœ¨äºåŒå­¦ä»¬èƒ½å¦æ•é”çš„è§‚å¯Ÿåˆ°user.txtæ–‡ä»¶çš„ä¿¡æ¯å¹¶è·å¾—è´¦å·å¯†ç ,è¿™ç‚¹æ˜¯å¾ˆé‡è¦çš„!

åœ¨å¹³æ—¶çš„æ¸—é€è¿‡ç¨‹ä¸­,æˆ‘ä»¬ä¹Ÿå¾€å¾€ä¼šé—æ¼æŸäº›ä¿¡æ¯,ä½†æ˜¯æˆ‘ä»¬éœ€è¦é€šè¿‡ä¸æ–­çš„è®­ç»ƒæå‡æˆ‘ä»¬çš„æ•é”ç¨‹åº¦,ä¸èƒ½æ”¾è¿‡ä¸€ä¸ä¸€æ¯«!

æœ€åé€šè¿‡ç®€å•çš„`sudo su`æˆåŠŸææƒ!

## é™„å½•

## 403Bypass

##### 1.æ—ç«™ç»•è¿‡

é€šè¿‡ä¿®æ”¹`Host`ä½†æ˜¯è®¿é—®åŒä¸€ipçš„æ–¹å¼è¿›è¡Œç»•è¿‡

åŸ:`Host: www.example.com`

ç°:`Host: abc.example.com`

##### 2.æ¥æºæ¬ºéª—

â€‹	`	Referer: 127.0.0.1`

æˆ–`Referer: https://example.com/auth/login`

â€‹	`X-Forwarded-For: 127.0.0.1`

â€‹	`X-Orginating-IP: 127.0.0.1`

â€‹	`	X-Remote-IP: 127.0.0.1`

##### 3.URLè¦†ç›–

åŸ:`GET /auth/login HTTP/1.1`

ç°:è®¿é—®ä¸å—é™åˆ¶çš„æ ¹è·¯å¾„`GET / HTTP/1.1`,ä½†å®é™…URLè¢«é‡å†™è¦†ç›–äº†

â€‹    `X-Original-URL: /auth/login`

â€‹	`X-Rewrite-URL: /auth/login`

##### åŸç†

æ€»çš„æ¥è¯´,å°±æ˜¯æ¬ºéª—æœåŠ¡å™¨è¯·æ±‚çš„æ¥æºä¸ç›®æ ‡

Xå¼€å¤´çš„å¤´éƒ¨ä¸ºæ‹“å±•å¤´éƒ¨,ç›®å‰ä¹Ÿå·²ç»è¢«å¤§å¤šæ•°åº”ç”¨æ‰€æ¥å—,è¿™äº›å¤´éƒ¨å¸¸ç”¨äºå¤šå±‚ä»£ç†ä¹‹é—´.

## æ–‡ä»¶ä¸Šä¼ ç»•è¿‡

##### 1.æ–‡ä»¶æ‰©å±•åç»•è¿‡jså‰ç«¯é™åˆ¶

åœ¨ä¸Šä¼ å‰å…ˆå°†`shell.php`æ›´æ”¹ä¸º`shell.jpg`,è¿›è¡Œä¸Šä¼ 

ç„¶åä½¿ç”¨burpæ‹¦æˆª,å°†`shell.jpg`æ”¹ä¸º`shell.php`

##### 2.æ–‡ä»¶ç±»å‹(MIME)

â€‹	`Content-Type: application/x-php`

â€‹	`Content-Type: image/png`

é€šè¿‡ä¿®æ”¹Content-Typeç±»å‹ä¸ºå›¾ç‰‡çš„ç±»å‹ç»•è¿‡æœåŠ¡ç«¯çš„æ£€æµ‹

##### 3.æ–‡ä»¶å¤´

`GIF89a`

åœ¨æ–‡ä»¶å†…å®¹çš„å¼€å¤´åŠ ä¸ŠGIT89aä¼ªé€ æˆå›¾ç‰‡æ–‡ä»¶

ä»¥ä¸Šå‡ ç§æ–¹æ³•åªæ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•,å…¶ä»–æ–¹æ³•è¯·è‡ªè¡Œå­¦ä¹ ~

## burpæ’ä»¶--[403bypasser.py](https://github.com/sting8k/BurpSuite_403Bypasser)

è¿™æ˜¯ä¸€æ¬¾burpçš„æ’ä»¶,å¯ä»¥è‡ªåŠ¨æ£€æµ‹ç½‘ç«™çš„403ç•Œé¢å¹¶å°è¯•ç»•è¿‡~

ç”±äºburpé»˜è®¤åªèƒ½è¿è¡Œ.jaræ’ä»¶,ä½†æ˜¯è¿™æ˜¯ä¸€æ¬¾pythonæ’ä»¶,æ‰€ä»¥æˆ‘ä»¬éœ€è¦[jython](https://www.jython.org/)å·¥å…·

é¦–å…ˆè§£å‹jythonå‹ç¼©åŒ…,æ‰“å¼€burp->Extender->Options->Python Environment,é€‰æ‹©jythonç›®å½•ä¸‹çš„jython.jaræ–‡ä»¶,è®¾ç½®ç¯å¢ƒ.

![æˆªå±2021-09-24 ä¸‹åˆ8.56.13](https://tva1.sinaimg.cn/large/008i3skNly1gus0ikdn11j61160u078c02.jpg)

ç„¶å,é€‰æ‹©Extenderä¸‹çš„Extensions,ç‚¹å‡»add![æˆªå±2021-09-24 ä¸‹åˆ8.57.53](https://tva1.sinaimg.cn/large/008i3skNly1gus0kazdxgj61160u00vw02.jpg)

é€‰æ‹©typeä¸ºpython,é€‰æ‹©403bypasser.pyæ–‡ä»¶,ç‚¹å‡»Nextå³å¯è‡ªåŠ¨é…ç½®~

é…ç½®å®Œæ¯•å,æ‰“å¼€403ç•Œé¢ä¼šè‡ªåŠ¨è¿›è¡Œæ‰«æå“¦~

æ‰«æåçš„ç»“æœä¼šå‡ºç°åœ¨Dashboard,è¯·æŸ¥çœ‹~

![æˆªå±2021-09-24 ä¸‹åˆ9.25.25](https://tva1.sinaimg.cn/large/008i3skNly1gus1cygpl6j618e0u0n4e02.jpg)

403bypasser.py:https://github.com/sting8k/BurpSuite_403Bypasser/

jython:https://www.jython.org/

# è‡´è°¢

**NaclğŸ‘Š**

